import{aa as pe,Y as Q,M as F,ab as Y,n as _e,X as N,$ as U,O as ne,K as H,ac as qe,L as I,c as de,b as Te,h as x,T as Ee,g as Se,r as X,a2 as we,a as A,w as ie,d as Ke,a1 as Ae,k as Le,ad as ze,N as re}from"./index-57RAIp0g.js";import{c as Fe,Q as $e}from"./QCheckbox-B0qXYHQC.js";import{Q as le}from"./QIcon-Cc8OfBfg.js";import{Q as Be}from"./QSpinner-bSmicc2C.js";import{u as Ne,a as Oe}from"./use-dark-DsmObZw5.js";const R={left:!0,right:!0,up:!0,down:!0,horizontal:!0,vertical:!0},Me=Object.keys(R);R.all=!0;function ae(e){const l={};for(const s of Me)e[s]===!0&&(l[s]=!0);return Object.keys(l).length===0?R:(l.horizontal===!0?l.left=l.right=!0:l.left===!0&&l.right===!0&&(l.horizontal=!0),l.vertical===!0?l.up=l.down=!0:l.up===!0&&l.down===!0&&(l.vertical=!0),l.horizontal===!0&&l.vertical===!0&&(l.all=!0),l)}const Pe=["INPUT","TEXTAREA"];function ue(e,l){return l.event===void 0&&e.target!==void 0&&e.target.draggable!==!0&&typeof l.handler=="function"&&Pe.includes(e.target.nodeName.toUpperCase())===!1&&(e.qClonedBy===void 0||e.qClonedBy.indexOf(l.uid)===-1)}function j(e,l,s){const b=U(e);let t,r=b.left-l.event.x,d=b.top-l.event.y,v=Math.abs(r),c=Math.abs(d);const f=l.direction;f.horizontal===!0&&f.vertical!==!0?t=r<0?"left":"right":f.horizontal!==!0&&f.vertical===!0?t=d<0?"up":"down":f.up===!0&&d<0?(t="up",v>c&&(f.left===!0&&r<0?t="left":f.right===!0&&r>0&&(t="right"))):f.down===!0&&d>0?(t="down",v>c&&(f.left===!0&&r<0?t="left":f.right===!0&&r>0&&(t="right"))):f.left===!0&&r<0?(t="left",v<c&&(f.up===!0&&d<0?t="up":f.down===!0&&d>0&&(t="down"))):f.right===!0&&r>0&&(t="right",v<c&&(f.up===!0&&d<0?t="up":f.down===!0&&d>0&&(t="down")));let E=!1;if(t===void 0&&s===!1){if(l.event.isFirst===!0||l.event.lastDir===void 0)return{};t=l.event.lastDir,E=!0,t==="left"||t==="right"?(b.left-=r,v=0,r=0):(b.top-=d,c=0,d=0)}return{synthetic:E,payload:{evt:e,touch:l.event.mouse!==!0,mouse:l.event.mouse===!0,position:b,direction:t,isFirst:l.event.isFirst,isFinal:s===!0,duration:Date.now()-l.event.time,distance:{x:v,y:c},offset:{x:r,y:d},delta:{x:b.left-l.event.lastX,y:b.top-l.event.lastY}}}}let De=0;const Re=pe({name:"touch-pan",beforeMount(e,{value:l,modifiers:s}){if(s.mouse!==!0&&F.has.touch!==!0)return;function b(r,d){s.mouse===!0&&d===!0?I(r):(s.stop===!0&&H(r),s.prevent===!0&&ne(r))}const t={uid:"qvtp_"+De++,handler:l,modifiers:s,direction:ae(s),noop:_e,mouseStart(r){ue(r,t)&&qe(r)&&(N(t,"temp",[[document,"mousemove","move","notPassiveCapture"],[document,"mouseup","end","passiveCapture"]]),t.start(r,!0))},touchStart(r){if(ue(r,t)){const d=r.target;N(t,"temp",[[d,"touchmove","move","notPassiveCapture"],[d,"touchcancel","end","passiveCapture"],[d,"touchend","end","passiveCapture"]]),t.start(r)}},start(r,d){if(F.is.firefox===!0&&Y(e,!0),t.lastEvt=r,d===!0||s.stop===!0){if(t.direction.all!==!0&&(d!==!0||t.modifiers.mouseAllDir!==!0&&t.modifiers.mousealldir!==!0)){const f=r.type.indexOf("mouse")!==-1?new MouseEvent(r.type,r):new TouchEvent(r.type,r);r.defaultPrevented===!0&&ne(f),r.cancelBubble===!0&&H(f),Object.assign(f,{qKeyEvent:r.qKeyEvent,qClickOutside:r.qClickOutside,qAnchorHandled:r.qAnchorHandled,qClonedBy:r.qClonedBy===void 0?[t.uid]:r.qClonedBy.concat(t.uid)}),t.initialEvent={target:r.target,event:f}}H(r)}const{left:v,top:c}=U(r);t.event={x:v,y:c,time:Date.now(),mouse:d===!0,detected:!1,isFirst:!0,isFinal:!1,lastX:v,lastY:c}},move(r){if(t.event===void 0)return;const d=U(r),v=d.left-t.event.x,c=d.top-t.event.y;if(v===0&&c===0)return;t.lastEvt=r;const f=t.event.mouse===!0,E=()=>{b(r,f);let _;s.preserveCursor!==!0&&s.preservecursor!==!0&&(_=document.documentElement.style.cursor||"",document.documentElement.style.cursor="grabbing"),f===!0&&document.body.classList.add("no-pointer-events--children"),document.body.classList.add("non-selectable"),Fe(),t.styleCleanup=T=>{if(t.styleCleanup=void 0,_!==void 0&&(document.documentElement.style.cursor=_),document.body.classList.remove("non-selectable"),f===!0){const h=()=>{document.body.classList.remove("no-pointer-events--children")};T!==void 0?setTimeout(()=>{h(),T()},50):h()}else T!==void 0&&T()}};if(t.event.detected===!0){t.event.isFirst!==!0&&b(r,t.event.mouse);const{payload:_,synthetic:T}=j(r,t,!1);_!==void 0&&(t.handler(_)===!1?t.end(r):(t.styleCleanup===void 0&&t.event.isFirst===!0&&E(),t.event.lastX=_.position.left,t.event.lastY=_.position.top,t.event.lastDir=T===!0?void 0:_.direction,t.event.isFirst=!1));return}if(t.direction.all===!0||f===!0&&(t.modifiers.mouseAllDir===!0||t.modifiers.mousealldir===!0)){E(),t.event.detected=!0,t.move(r);return}const q=Math.abs(v),S=Math.abs(c);q!==S&&(t.direction.horizontal===!0&&q>S||t.direction.vertical===!0&&q<S||t.direction.up===!0&&q<S&&c<0||t.direction.down===!0&&q<S&&c>0||t.direction.left===!0&&q>S&&v<0||t.direction.right===!0&&q>S&&v>0?(t.event.detected=!0,t.move(r)):t.end(r,!0))},end(r,d){if(t.event!==void 0){if(Q(t,"temp"),F.is.firefox===!0&&Y(e,!1),d===!0)t.styleCleanup!==void 0&&t.styleCleanup(),t.event.detected!==!0&&t.initialEvent!==void 0&&t.initialEvent.target.dispatchEvent(t.initialEvent.event);else if(t.event.detected===!0){t.event.isFirst===!0&&t.handler(j(r===void 0?t.lastEvt:r,t).payload);const{payload:v}=j(r===void 0?t.lastEvt:r,t,!0),c=()=>{t.handler(v)};t.styleCleanup!==void 0?t.styleCleanup(c):c()}t.event=void 0,t.initialEvent=void 0,t.lastEvt=void 0}}};if(e.__qtouchpan=t,s.mouse===!0){const r=s.mouseCapture===!0||s.mousecapture===!0?"Capture":"";N(t,"main",[[e,"mousedown","mouseStart",`passive${r}`]])}F.has.touch===!0&&N(t,"main",[[e,"touchstart","touchStart",`passive${s.capture===!0?"Capture":""}`],[e,"touchmove","noop","notPassiveCapture"]])},updated(e,l){const s=e.__qtouchpan;s!==void 0&&(l.oldValue!==l.value&&(typeof value!="function"&&s.end(),s.handler=l.value),s.direction=ae(l.modifiers))},beforeUnmount(e){const l=e.__qtouchpan;l!==void 0&&(l.event!==void 0&&l.end(),Q(l,"main"),Q(l,"temp"),F.is.firefox===!0&&Y(e,!1),l.styleCleanup!==void 0&&l.styleCleanup(),delete e.__qtouchpan)}}),Qe=de({name:"QSlideTransition",props:{appear:Boolean,duration:{type:Number,default:300}},emits:["show","hide"],setup(e,{slots:l,emit:s}){let b=!1,t,r,d=null,v=null,c,f;function E(){t&&t(),t=null,b=!1,d!==null&&(clearTimeout(d),d=null),v!==null&&(clearTimeout(v),v=null),r!==void 0&&r.removeEventListener("transitionend",c),c=null}function q(h,K,k){K!==void 0&&(h.style.height=`${K}px`),h.style.transition=`height ${e.duration}ms cubic-bezier(.25, .8, .50, 1)`,b=!0,t=k}function S(h,K){h.style.overflowY=null,h.style.height=null,h.style.transition=null,E(),K!==f&&s(K)}function _(h,K){let k=0;r=h,b===!0?(E(),k=h.offsetHeight===h.scrollHeight?0:void 0):(f="hide",h.style.overflowY="hidden"),q(h,k,K),d=setTimeout(()=>{d=null,h.style.height=`${h.scrollHeight}px`,c=w=>{v=null,(Object(w)!==w||w.target===h)&&S(h,"show")},h.addEventListener("transitionend",c),v=setTimeout(c,e.duration*1.1)},100)}function T(h,K){let k;r=h,b===!0?E():(f="show",h.style.overflowY="hidden",k=h.scrollHeight),q(h,k,K),d=setTimeout(()=>{d=null,h.style.height=0,c=w=>{v=null,(Object(w)!==w||w.target===h)&&S(h,"hide")},h.addEventListener("transitionend",c),v=setTimeout(c,e.duration*1.1)},100)}return Te(()=>{b===!0&&E()}),()=>x(Ee,{css:!1,appear:e.appear,onEnter:_,onLeave:T},l.default)}}),Ye=["none","strict","leaf","leaf-filtered"],Ve=de({name:"QTree",props:{...Ne,nodes:{type:Array,required:!0},nodeKey:{type:String,required:!0},labelKey:{type:String,default:"label"},childrenKey:{type:String,default:"children"},dense:Boolean,color:String,controlColor:String,textColor:String,selectedColor:String,icon:String,tickStrategy:{type:String,default:"none",validator:e=>Ye.includes(e)},ticked:Array,expanded:Array,selected:{},noSelectionUnset:Boolean,defaultExpandAll:Boolean,accordion:Boolean,filter:String,filterMethod:Function,duration:{},noConnectors:Boolean,noTransition:Boolean,noNodesLabel:String,noResultsLabel:String},emits:["update:expanded","update:ticked","update:selected","lazyLoad","afterShow","afterHide"],setup(e,{slots:l,emit:s}){const{proxy:b}=Se(),{$q:t}=b,r=Oe(e,t),d=X({}),v=X(e.ticked||[]),c=X(e.expanded||[]);let f={};we(()=>{f={}});const E=A(()=>`q-tree q-tree--${e.dense===!0?"dense":"standard"}`+(e.noConnectors===!0?" q-tree--no-connectors":"")+(r.value===!0?" q-tree--dark":"")+(e.color!==void 0?` text-${e.color}`:"")),q=A(()=>e.selected!==void 0),S=A(()=>e.icon||t.iconSet.tree.icon),_=A(()=>e.controlColor||e.color),T=A(()=>e.textColor!==void 0?` text-${e.textColor}`:""),h=A(()=>{const i=e.selectedColor||e.color;return i?` text-${i}`:""}),K=A(()=>e.filterMethod!==void 0?e.filterMethod:(i,a)=>{const n=a.toLowerCase();return i[e.labelKey]&&i[e.labelKey].toLowerCase().indexOf(n)!==-1}),k=A(()=>{const i={},a=(n,o)=>{const u=n.tickStrategy||(o?o.tickStrategy:e.tickStrategy),g=n[e.nodeKey],m=n[e.childrenKey]&&Array.isArray(n[e.childrenKey])&&n[e.childrenKey].length!==0,L=n.disabled!==!0&&q.value===!0&&n.selectable!==!1,p=n.disabled!==!0&&n.expandable!==!1,Ce=u!=="none",B=u==="strict",ee=u==="leaf-filtered",P=u==="leaf"||u==="leaf-filtered";let D=n.disabled!==!0&&n.tickable!==!1;P===!0&&D===!0&&o&&o.tickable!==!0&&(D=!1);let z=n.lazy;z===!0&&d.value[g]!==void 0&&Array.isArray(n[e.childrenKey])===!0&&(z=d.value[g]);const y={key:g,parent:o,isParent:m,lazy:z,disabled:n.disabled,link:n.disabled!==!0&&(L===!0||p===!0&&(m===!0||z===!0)),children:[],matchesFilter:e.filter?K.value(n,e.filter):!0,selected:g===e.selected&&L===!0,selectable:L,expanded:m===!0?c.value.includes(g):!1,expandable:p,noTick:n.noTick===!0||B!==!0&&z&&z!=="loaded",tickable:D,tickStrategy:u,hasTicking:Ce,strictTicking:B,leafFilteredTicking:ee,leafTicking:P,ticked:B===!0?v.value.includes(g):m===!0?!1:v.value.includes(g)};if(i[g]=y,m===!0&&(y.children=n[e.childrenKey].map(C=>a(C,y)),e.filter&&(y.matchesFilter!==!0?y.matchesFilter=y.children.some(C=>C.matchesFilter):y.noTick!==!0&&y.disabled!==!0&&y.tickable===!0&&ee===!0&&y.children.every(C=>C.matchesFilter!==!0||C.noTick===!0||C.tickable!==!0)===!0&&(y.tickable=!1)),y.matchesFilter===!0&&(y.noTick!==!0&&B!==!0&&y.children.every(C=>C.noTick)===!0&&(y.noTick=!0),P))){if(y.ticked=!1,y.indeterminate=y.children.some(C=>C.indeterminate===!0),y.tickable=y.tickable===!0&&y.children.some(C=>C.tickable),y.indeterminate!==!0){const C=y.children.reduce((te,xe)=>xe.ticked===!0?te+1:te,0);C===y.children.length?y.ticked=!0:C>0&&(y.indeterminate=!0)}y.indeterminate===!0&&(y.indeterminateNextState=y.children.every(C=>C.tickable!==!0||C.ticked!==!0))}return y};return e.nodes.forEach(n=>a(n,null)),i});ie(()=>e.ticked,i=>{v.value=i}),ie(()=>e.expanded,i=>{c.value=i});function w(i){const a=[].reduce,n=(o,u)=>{if(o||!u)return o;if(Array.isArray(u)===!0)return a.call(Object(u),n,o);if(u[e.nodeKey]===i)return u;if(u[e.childrenKey])return n(null,u[e.childrenKey])};return n(null,e.nodes)}function oe(){return v.value.map(i=>w(i))}function se(){return c.value.map(i=>w(i))}function ce(i){return i&&k.value[i]?k.value[i].expanded:!1}function fe(){e.expanded!==void 0?s("update:expanded",[]):c.value=[]}function V(){const i=[],a=n=>{n[e.childrenKey]&&n[e.childrenKey].length!==0&&n.expandable!==!1&&n.disabled!==!0&&(i.push(n[e.nodeKey]),n[e.childrenKey].forEach(a))};e.nodes.forEach(a),e.expanded!==void 0?s("update:expanded",i):c.value=i}function O(i,a,n=w(i),o=k.value[i]){if(o.lazy&&o.lazy!=="loaded"){if(o.lazy==="loading")return;d.value[i]="loading",Array.isArray(n[e.childrenKey])!==!0&&(n[e.childrenKey]=[]),s("lazyLoad",{node:n,key:i,done:u=>{d.value[i]="loaded",n[e.childrenKey]=Array.isArray(u)===!0?u:[],Ke(()=>{const g=k.value[i];g&&g.isParent===!0&&G(i,!0)})},fail:()=>{delete d.value[i],n[e.childrenKey].length===0&&delete n[e.childrenKey]}})}else o.isParent===!0&&o.expandable===!0&&G(i,a)}function G(i,a){let n=c.value;const o=e.expanded!==void 0;if(o===!0&&(n=n.slice()),a){if(e.accordion&&k.value[i]){const u=[];k.value[i].parent?k.value[i].parent.children.forEach(g=>{g.key!==i&&g.expandable===!0&&u.push(g.key)}):e.nodes.forEach(g=>{const m=g[e.nodeKey];m!==i&&u.push(m)}),u.length!==0&&(n=n.filter(g=>u.includes(g)===!1))}n=n.concat([i]).filter((u,g,m)=>m.indexOf(u)===g)}else n=n.filter(u=>u!==i);o===!0?s("update:expanded",n):c.value=n}function he(i){return i&&k.value[i]?k.value[i].ticked:!1}function $(i,a){let n=v.value;const o=e.ticked!==void 0;o===!0&&(n=n.slice()),a?n=n.concat(i).filter((u,g,m)=>m.indexOf(u)===g):n=n.filter(u=>i.includes(u)===!1),o===!0&&s("update:ticked",n)}function ve(i,a,n){const o={tree:b,node:i,key:n,color:e.color,dark:r.value};return re(o,"expanded",()=>a.expanded,u=>{u!==a.expanded&&O(n,u)}),re(o,"ticked",()=>a.ticked,u=>{u!==a.ticked&&$([n],u)}),o}function J(i){return(e.filter?i.filter(a=>k.value[a[e.nodeKey]].matchesFilter):i).map(a=>me(a))}function ye(i){if(i.icon!==void 0)return x(le,{class:"q-tree__icon q-mr-sm",name:i.icon,color:i.iconColor});const a=i.img||i.avatar;if(a)return x("img",{class:`q-tree__${i.img?"img":"avatar"} q-mr-sm`,src:a})}function ge(){s("afterShow")}function be(){s("afterHide")}function me(i){const a=i[e.nodeKey],n=k.value[a],o=i.header&&l[`header-${i.header}`]||l["default-header"],u=n.isParent===!0?J(i[e.childrenKey]):[],g=u.length!==0||n.lazy&&n.lazy!=="loaded";let m=i.body&&l[`body-${i.body}`]||l["default-body"];const L=o!==void 0||m!==void 0?ve(i,n,a):null;return m!==void 0&&(m=x("div",{class:"q-tree__node-body relative-position"},[x("div",{class:T.value},[m(L)])])),x("div",{key:a,class:`q-tree__node relative-position q-tree__node--${g===!0?"parent":"child"}`},[x("div",{class:"q-tree__node-header relative-position row no-wrap items-center"+(n.link===!0?" q-tree__node--link q-hoverable q-focusable":"")+(n.selected===!0?" q-tree__node--selected":"")+(n.disabled===!0?" q-tree__node--disabled":""),tabindex:n.link===!0?0:-1,ariaExpanded:u.length>0?n.expanded:null,role:"treeitem",onClick:p=>{Z(i,n,p)},onKeypress(p){Ae(p)!==!0&&(p.keyCode===13?Z(i,n,p,!0):p.keyCode===32&&M(i,n,p,!0))}},[x("div",{class:"q-focus-helper",tabindex:-1,ref:p=>{f[n.key]=p}}),n.lazy==="loading"?x(Be,{class:"q-tree__spinner",color:_.value}):g===!0?x(le,{class:"q-tree__arrow"+(n.expanded===!0?" q-tree__arrow--rotate":""),name:S.value,onClick(p){M(i,n,p)}}):null,n.hasTicking===!0&&n.noTick!==!0?x($e,{class:"q-tree__tickbox",modelValue:n.indeterminate===!0?null:n.ticked,color:_.value,dark:r.value,dense:!0,keepColor:!0,disable:n.tickable!==!0,onKeydown:I,"onUpdate:modelValue":p=>{ke(n,p)}}):null,x("div",{class:"q-tree__node-header-content col row no-wrap items-center"+(n.selected===!0?h.value:T.value)},[o?o(L):[ye(i),x("div",i[e.labelKey])]])]),g===!0?e.noTransition===!0?n.expanded===!0?x("div",{class:"q-tree__node-collapsible"+T.value,key:`${a}__q`},[m,x("div",{class:"q-tree__children"+(n.disabled===!0?" q-tree__node--disabled":""),role:"group"},u)]):null:x(Qe,{duration:e.duration,onShow:ge,onHide:be},()=>Le(x("div",{class:"q-tree__node-collapsible"+T.value,key:`${a}__q`},[m,x("div",{class:"q-tree__children"+(n.disabled===!0?" q-tree__node--disabled":""),role:"group"},u)]),[[ze,n.expanded]])):m])}function W(i){const a=f[i];a&&a.focus()}function Z(i,a,n,o){o!==!0&&a.selectable!==!1&&W(a.key),q.value&&a.selectable?e.noSelectionUnset===!1?s("update:selected",a.key!==e.selected?a.key:null):a.key!==e.selected&&s("update:selected",a.key===void 0?null:a.key):M(i,a,n,o),typeof i.handler=="function"&&i.handler(i)}function M(i,a,n,o){n!==void 0&&I(n),o!==!0&&a.selectable!==!1&&W(a.key),O(a.key,!a.expanded,i,a)}function ke(i,a){if(i.indeterminate===!0&&(a=i.indeterminateNextState),i.strictTicking)$([i.key],a);else if(i.leafTicking){const n=[],o=u=>{u.isParent?(a!==!0&&u.noTick!==!0&&u.tickable===!0&&n.push(u.key),u.leafTicking===!0&&u.children.forEach(o)):u.noTick!==!0&&u.tickable===!0&&(u.leafFilteredTicking!==!0||u.matchesFilter===!0)&&n.push(u.key)};o(i),$(n,a)}}return e.defaultExpandAll===!0&&V(),Object.assign(b,{getNodeByKey:w,getTickedNodes:oe,getExpandedNodes:se,isExpanded:ce,collapseAll:fe,expandAll:V,setExpanded:O,isTicked:he,setTicked:$}),()=>{const i=J(e.nodes);return x("div",{class:E.value,role:"tree"},i.length===0?e.filter?e.noResultsLabel||t.lang.tree.noResults:e.noNodesLabel||t.lang.tree.noNodes:i)}}});export{Ve as Q,Re as T};
